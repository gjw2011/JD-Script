name: JD 京东脚本（直链版，永不卡死）

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0,6,12,18 * * *'

jobs:
  run:
    runs-on: ubuntu-latest
    steps:
      - name: 用 Node 20
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: 直接运行京东任务（不 clone 仓库，全部直链最新版）
        env:
          JD_COOKIE: ${{ secrets.JD_COOKIE }}
        run: |
          echo "开始跑京东任务 $(date)"
          
          node -e "require('https').get('https://raw.githubusercontent.com/6dylan6/jdpro/main/jd_bean_sign.js', r=>r.on('data',d=>process.stdout.write(d))).on('error',()=>console.log('签到脚本加载失败'))"
          
          node -e "require('https').get('https://raw.githubusercontent.com/6dylan6/jdpro/main/jd_plantBean.js', r=>r.on('data',d=>process.stdout.write(d))).on('error',()=>console.log('农场脚本加载失败'))"
          
          node -e "require('https').get('https://raw.githubusercontent.com/6dylan6/jdpro/main/jd_pet.js', r=>r.on('data',d=>process.stdout.write(d))).on('error',()=>console.log('萌宠脚本加载失败'))"
          
          node -e "require('https').get('https://raw.githubusercontent.com/6dylan6/jdpro/main/jd_joy.js', r=>r.on('data',d=>process.stdout.write(d))).on('error',()=>console.log('疯狂Joy加载失败'))"
          
          echo "全部跑完 $(date)"
