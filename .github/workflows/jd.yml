name: JD 京东脚本自动化（带完整日志）

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0,6,12,18 * * *'

jobs:
  run:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with: { node-version: 20 }

      - name: 拉最新 jdpro + 运行全任务（完整日志）
        env:
          JD_COOKIE: ${{ secrets.JD_COOKIE }}
        run: |
          git clone https://github.com/6dylan6/jdpro.git ~/jdpro && cd ~/jdpro
          echo "========== $(date) 开始执行京东任务 =========="
          node jd_bean_sign.js
          node jd_plantBean.js
          node jd_pet.js
          node jd_joy.js
          node jd_joy_run.js
          node jd_superMarket.js
          node jd_jxfactory.js
          echo "========== $(date) 全部执行完毕 =========="

      - name: 上传日志方便查看
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: jd日志
          path: ~/jdpro/*.log
